/*! onecontext 1.2.0 */
import{setupContext as t}from"@seamless/one-context";import{PersistentConnection as e}from"@seamless/store";import{useSSRContext as n}from"vue";var s;!function(t){t.store="store",t.static="static"}(s||(s={})),s.static,s.store;class OneContextPersistentStore extends e{type=s.store}class OneContextStatic{type=s.static}const o=()=>"undefined"!=typeof window;class PageEnvironmentConnection extends OneContextStatic{get initialState(){if(!o()){const t=n();return{pageEnvironmentVariables:t?.AEMContext.pageAEMContext,environmentVariables:t?.AEMContext.globalAEMContext}}const t=window.top||window;return{pageEnvironmentVariables:t.aemNamespace.pageEnvironmentVariables,environmentVariables:t.aemNamespace.environmentVariables}}getContext=async()=>this.initialState}const r="UPDATE_AFFINITY_SCORE",i={};class MBScoreConnection extends OneContextPersistentStore{allowedTenants=["cuan"];constructor(){super("MBSCORE_CONNECTION")}get initialState(){return i}get storageType(){return"local"}loadPersistedStateCallback(t){return this.getAction("MBSCORE_LOAD_PERSISTED_STATE",t)}async transformToPersistentState(t){return t}getReducer(){return(t=i,e)=>e.type===this.getActionType(r)?{...t,...e.payload}:t}getPublicDispatchers(){return{updateAffinityScore:t=>this.getAction(r,t)}}}const a="UPDATE_DEALER_CONTEXT";class DealerContextConnection extends OneContextPersistentStore{allowedTenants=["seamless"];constructor(){super("DEALER_CONTEXT_CONNECTION")}async onBeforeRegister(t){const e=await this.loadPersistedStateCallback(this.initialState);null!=e&&t(e),await this.storeState(this.initialState)}get initialState(){if(!o()){const t=n();return t?.AEMContext.dealerContext}const t=window.top||window;if(t.aemNamespace.dealerContext)return{allOutletId:t.aemNamespace.dealerContext.allOutletId,outletId:t.aemNamespace.dealerContext.outletId};const e=new URLSearchParams(window.location.search);if((s=e).has("allOutletId")||s.has("outletId")||s.has("gsOutletId")||s.has("allGsOutletIds"))return(t=>{const e={};return t.has("allGsOutletIds")&&(e.allOutletId=t.get("allGsOutletIds")),t.has("allOutletId")&&(e.allOutletId=t.get("allOutletId")),t.has("gsOutletId")&&(e.outletId=t.get("gsOutletId")),t.has("outletId")&&(e.outletId=t.get("outletId")),e})(e);var s;const r=`swsp:${this.name}`;if(sessionStorage.getItem(r)){return JSON.parse(sessionStorage.getItem(r))}return{}}get storageType(){return"session"}loadPersistedStateCallback(t){return this.getAction("DEALER_CONTEXT_LOAD_PERSISTED_STATE",t)}async transformToPersistentState(t){return t}getReducer(){return(t=this.initialState,e)=>e.type===this.getActionType(a)?{...t,...e.payload}:t}getPublicDispatchers(){return{updateDealerContext:t=>this.getAction(a,t)}}}const c="UPDATE_USER_VEHICLE",l={selectedVehicleVin:""};class UserVehicleConnection extends OneContextPersistentStore{allowedTenants=["mmv"];constructor(){super("USER_VEHICLE_CONNECTION")}async onBeforeRegister(t){const e=await this.loadPersistedStateCallback(this.initialState);null!=e&&t(e),await this.storeState(this.initialState)}get initialState(){const t=`swsp:${this.name}`,e=!!o()&&sessionStorage.getItem(t);return e?JSON.parse(e):l}get storageType(){return"session"}loadPersistedStateCallback(t){return this.getAction("USER_VEHICLE_LOAD_PERSISTED_STATE",t)}async transformToPersistentState(t){return t}getReducer(){return(t=l,e)=>e.type===this.getActionType(c)?{...t,...e.payload}:t}getPublicDispatchers(){return{updateUserVehicle:t=>this.getAction(c,t)}}}(async()=>{t({name:"PageConnection",connectionMethod:PageEnvironmentConnection,tenant:"mbmxp"}),t({name:"MBScoreConnection",connectionMethod:MBScoreConnection,tenant:"cuan"}),t({name:"DealerContextConnection",connectionMethod:DealerContextConnection,tenant:"seamless"}),t({name:"UserVehicleConnection",connectionMethod:UserVehicleConnection,tenant:"mmv"})})();
//# sourceMappingURL=index.js.map
